<a name="module_reference"><h1>Reference for Module MMTK</h1></a>





<p>MMTK is the base module of the Molecular Modelling Toolkit.
It contains the most common objects and all submodules. As a convenience
to the user, it also imports some commonly used objects from other
libraries:</p>



<ul>


<li> <p>

<tt>Vector</tt> from <tt>Scientific.Geometry</tt>

</p>

<li> <p>

<tt>Translation</tt> and <tt>Rotation</tt> from <tt>Scientific.Geometry.Transformation</tt>

</p>

<li> <p>

<tt>copy</tt> and <tt>deepcopy</tt> from <tt>copy</tt>

</p>

<li> <p>

<tt>stdin</tt>, <tt>stdout</tt>, and <tt>stderr</tt> from <tt>sys</tt>

</p>

</ul>






























<hr width=70%>
<h2>Functions</h2>





<ul>


<li> <p>

<a name="Function:MMTK.save"><b><i>save</i></b>()</a><br>


</p>



<p>Writes <i>object</i> to a newly created file with the name <i>filename</i>,
for later retrieval by <tt>load()</tt>.</p>

<li> <p>

<a name="Function:MMTK.load"><b><i>load</i></b>()</a><br>


</p>



<p>Loads the file indicated by <i>filename</i>, which must have been produced
by <tt>save()</tt>, and returns the object stored in that file.</p>

</ul>




<h1>Submodules:</h1>
<ul><li><a href="MMTK_11.html">Module MMTK.Biopolymers</a></ul>


<ul><li><a href="MMTK_12.html">Module MMTK.ChargeFit</a></ul>


<ul><li><a href="MMTK_13.html">Module MMTK.ChemicalObjects</a></ul>


<ul><li><a href="MMTK_14.html">Module MMTK.Collection</a></ul>


<ul><li><a href="MMTK_15.html">Module MMTK.DCD</a></ul>


<ul><li><a href="MMTK_16.html">Module MMTK.Deformation</a></ul>


<ul><li><a href="MMTK_17.html">Module MMTK.Dynamics</a></ul>


<ul><li><a href="MMTK_18.html">Module MMTK.Environment</a></ul>


<ul><li><a href="MMTK_19.html">Module MMTK.Field</a></ul>


<ul><li><a href="MMTK_20.html">Module MMTK.ForceFields</a></ul>


<ul><li><a href="MMTK_25.html">Module MMTK.FourierBasis</a></ul>


<ul><li><a href="MMTK_26.html">Module MMTK.Geometry</a></ul>


<ul><li><a href="MMTK_27.html">Module MMTK.Minimization</a></ul>


<ul><li><a href="MMTK_28.html">Module MMTK.MolecularSurface</a></ul>


<ul><li><a href="MMTK_29.html">Module MMTK.NormalModes</a></ul>


<ul><li><a href="MMTK_30.html">Module MMTK.NucleicAcids</a></ul>


<ul><li><a href="MMTK_31.html">Module MMTK.PDB</a></ul>


<ul><li><a href="MMTK_32.html">Module MMTK.ParticleProperties</a></ul>


<ul><li><a href="MMTK_33.html">Module MMTK.Proteins</a></ul>


<ul><li><a href="MMTK_34.html">Module MMTK.Random</a></ul>


<ul><li><a href="MMTK_35.html">Module MMTK.Solvation</a></ul>


<ul><li><a href="MMTK_36.html">Module MMTK.Subspace</a></ul>


<ul><li><a href="MMTK_37.html">Module MMTK.Trajectory</a></ul>


<ul><li><a href="MMTK_38.html">Module MMTK.Units</a></ul>


<ul><li><a href="MMTK_39.html">Module MMTK.Universe</a></ul>


<ul><li><a href="MMTK_40.html">Module MMTK.Visualization</a></ul>


<ul><li><a href="MMTK_41.html">Module MMTK.Visualization_win32</a></ul>


<hr width=70%>
<a name="Class:MMTK.ParticleScalar"><h2>Class ParticleScalar: Scalar property defined for each particle</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_32.html#Class:MMTK.ParticleProperties.ParticleProperty">MMTK.ParticleProperties.ParticleProperty</a>.</p>



<p>ParticleScalar objects can be added to each other and
multiplied with scalars.
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>maximum</i></b>()


<p>Returns the highest value for any particle.</p>





<li> <b><i>minimum</i></b>()


<p>Returns the smallest value for any particle.</p>





<li> <b><i>applyFunction</i></b>(<i>function</i>)




<p>Applies <i>function</i> to each value and returns the result
as a new ParticleScalar object.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.ParticleVector"><h2>Class ParticleVector: Vector property defined for each particle</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_32.html#Class:MMTK.ParticleProperties.ParticleProperty">MMTK.ParticleProperties.ParticleProperty</a>.</p>



<p>ParticleVector objects can be added to each other and
multiplied with scalars or <a href="MMTK_10.html#Class:MMTK.ParticleScalar">MMTK.ParticleScalar</a> objects; all
of these operations result in another ParticleVector
object. Multiplication with a vector or another ParticleVector object
yields a <a href="MMTK_10.html#Class:MMTK.ParticleScalar">MMTK.ParticleScalar</a> object containing the dot products
for each particle. Multiplications that treat ParticleVectors
as vectors in a 3N-dimensional space are implemented as methods.
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>length</i></b>()


<p>Returns a ParticleScalar containing the length of the vector
for each particle.</p>





<li> <b><i>norm</i></b>()


<p>Returns the norm of the ParticleVector seen as a
3N-dimensional vector.</p>





<li> <b><i>dotProduct</i></b>(<i>other</i>)




<p>Returns the dot product with <i>other</i> (a ParticleVector)
treating both operands as 3N-dimensional vectors.</p>





<li> <b><i>massWeightedDotProduct</i></b>(<i>other</i>)




<p>Returns the mass-weighted dot product with <i>other</i>
(a ParticleVector object) treating both operands as
3N-dimensional vectors.</p>





<li> <b><i>dyadicProduct</i></b>(<i>other</i>)




<p>Returns a <a href="MMTK_10.html#Class:MMTK.ParticleTensor">MMTK.ParticleTensor</a> object representing the dyadic
product with <i>other</i> (a ParticleVector).</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.Configuration"><h2>Class Configuration: Configuration of a universe</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_10.html#Class:MMTK.ParticleVector">MMTK.ParticleVector</a>.</p>



<p>Its instances represent a configuration of a universe, consisting
of positions for all atoms (like in a ParticleVector) plus
the geometry of the universe itself, e.g. the cell shape for
periodic universes.
</p>



<hr width=70%>
<a name="Class:MMTK.ParticleTensor"><h2>Class ParticleTensor: Rank-2 tensor property defined for each particle</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_32.html#Class:MMTK.ParticleProperties.ParticleProperty">MMTK.ParticleProperties.ParticleProperty</a>.</p>



<p>ParticleTensor objects can be added to each other and
multiplied with scalars or <a href="MMTK_10.html#Class:MMTK.ParticleScalar">MMTK.ParticleScalar</a> objects; all
of these operations result in another ParticleTensor
object.
</p>



<hr width=70%>
<a name="Class:MMTK.Atom"><h2>Class Atom: Atom</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_13.html#Class:MMTK.ChemicalObjects.ChemicalObject">MMTK.ChemicalObjects.ChemicalObject</a>.</p>



<p>Constructor: Atom(<i>element</i>, **|properties|)</p>



<p><dl>


<dt><i>element</i></dt>


<dd><p>
a string (not case sensitive) specifying the chemical element</p></dd>


<dt><i>properties</i></dt>


<dd><p>
optional keyword properties:<ul>


<li> <p>
position: the atom position (a vector)
</p>

<li> <p>
name: the atom name (a string)
</p>

</ul>


</p></dd>


</dl>
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>setPosition</i></b>(<i>position</i>)




<p>Changes the position to <i>position</i>.</p>





<li> <b><i>position</i></b>(<i>conf</i>=<tt>None</tt>)




<p>Returns the position in configuration <i>conf</i>. If <i>conf</i> is
<tt>None</tt>, use the current configuration. If the atom has not been
assigned a position, the return value is <tt>None</tt>.</p>





<li> <b><i>setMass</i></b>(<i>mass</i>)




<p>Set the atom mass to <i>mass</i>.</p>





<li> <b><i>bondedTo</i></b>()


<p>Returns a list of all atoms to which a chemical bond exists.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.Collection"><h2>Class Collection: Collection of chemical objects</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_14.html#Class:MMTK.Collection.GroupOfAtoms">MMTK.Collection.GroupOfAtoms</a>
and <a href="MMTK_40.html#Class:MMTK.Visualization.Viewable">MMTK.Visualization.Viewable</a>.</p>



<p>Collections permit the grouping of arbitrary chemical objects
(atoms, molecules, etc.) into one object for the purpose of analysis
or manipulation.</p>



<p>Constructor: Collection(<i>objects</i>=None)</p>



<p><dl>


<dt><i>objects</i></dt>


<dd><p>
a chemical object or a sequence of chemical objects that
             define the initial content of the collection.</p></dd>


</dl>
</p>



<p>Collections permit length inquiry, item extraction by indexing,
and iteration, like any Python sequence object. Two collections
can be added to yield a collection that contains the combined
elements.
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>addObject</i></b>(<i>object</i>)




<p>Adds <i>object</i> to the collection. If <i>object</i> is another collection
or a list, all of its elements are added.</p>





<li> <b><i>removeObject</i></b>(<i>object</i>)




<p>Removes <i>object</i> from the collection. If <i>object</i> is a collection
or a list, each of its elements is removed. The object to be removed
must be an element of the collection.</p>





<li> <b><i>selectShell</i></b>(<i>point</i>, <i>r1</i>, <i>r2</i>=<tt>0.0</tt>)








<p>Return a collection of all elements whose
distance from <i>point</i> is between <i>r1</i> and <i>r2</i>.</p>





<li> <b><i>selectBox</i></b>(<i>p1</i>, <i>p2</i>)






<p>Return a collection of all elements that lie
within a box whose corners are given by <i>p1</i> and <i>p2</i>.</p>





<li> <b><i>objectList</i></b>(<i>klass</i>=<tt>None</tt>)




<p>Returns a list of all objects in the collection.
If <i>klass</i> is not None, only objects whose class is equal
to <i>klass</i> are returned.</p>





<li> <b><i>atomList</i></b>()


<p>Returns a list containing all atoms of all objects in the collection.</p>





<li> <b><i>numberOfAtoms</i></b>()


<p>Returns the total number of atoms in the objects of the collection.</p>





<li> <b><i>universe</i></b>()


<p>Returns the universe of which the objects in the collection
are part. If no such universe exists, the return value is <tt>None</tt>.</p>





<li> <b><i>map</i></b>(<i>function</i>)




<p>Applies <i>function</i> to all objects in the collection and
returns the list of the results. If the results are chemical
objects, a Collection object is returned instead of a list.</p>





<li> <b><i>distanceConstraintList</i></b>()


<p>Returns the list of distance constraints.</p>





<li> <b><i>numberOfDistanceConstraints</i></b>()


<p>Returns the number of distance constraints.</p>





<li> <b><i>setBondConstraints</i></b>(<i>universe</i>=<tt>None</tt>)




<p>Sets distance constraints for all bonds.</p>





<li> <b><i>removeDistanceConstraints</i></b>(<i>universe</i>=<tt>None</tt>)




<p>Removes all distance constraints.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.Molecule"><h2>Class Molecule: Molecule</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_13.html#Class:MMTK.ChemicalObjects.ChemicalObject">MMTK.ChemicalObjects.ChemicalObject</a>.</p>



<p>Molecules consist of atoms and groups linked by bonds.</p>



<p>Constructor: Molecule(<i>species</i>, **|properties|)</p>



<p><dl>


<dt><i>species</i></dt>


<dd><p>
a string (not case sensitive) that specifies the molecule
             name in the chemical database</p></dd>


<dt><i>properties</i></dt>


<dd><p>
optional keyword properties:<ul>


<li> <p>
position: the center-of-mass position (a vector)
</p>

<li> <p>
configuration: the name of a configuration listed in the database
                   definition of the molecule, which is used to
                   initialize the atom positions. If no configuration
                   is specified, the configuration named "default" will
                   be used, if it exists. Otherwise the atom positions
                   are undefined.
</p>

<li> <p>
name: the atom name (a string)
</p>

</ul>


</p></dd>


</dl>
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>findHydrogenPositions</i></b>()


<p>Find reasonable positions for hydrogen atoms that have no
position assigned.</p>



<p>This method uses a heuristic approach based on standard geometry
data. It was developed for proteins and DNA and may not give
good results for other molecules. It raises an exception
if presented with a topology it cannot handle.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.PartitionedCollection"><h2>Class PartitionedCollection: Collection with cubic partitions</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_10.html#Class:MMTK.Collection">MMTK.Collection</a>.</p>



<p>A PartitionedCollection differs from a plain Collection by
sorting its elements into small cubic cells. This makes adding
objects slower, but geometrical operations like 
selectShell become much faster for a large number of
objects.</p>



<p>Constructor: PartitionedCollection(<i>partition_size</i>, <i>objects</i>=None)</p>



<p><dl>


<dt><i>partition_size</i></dt>


<dd><p>
the edge length of the cubic cells</p></dd>


<dt><i>objects</i></dt>


<dd><p>
a chemical object or a sequence of chemical objects that
             define the initial content of the collection.
</p></dd>


</dl>
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>partitions</i></b>()


<p>Returns a list of cubic partitions. Each partition is specified
by a tuple containing two vectors (describing the diagonally
opposite corners) and the list of objects in the partition.</p>





<li> <b><i>pairsWithinCutoff</i></b>(<i>cutoff</i>)




<p>Returns a list containing all pairs of objects in the
collection whose center-of-mass distance is less than <i>cutoff</i>.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.PartitionedAtomCollection"><h2>Class PartitionedAtomCollection: Partitioned collection of atoms</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_10.html#Class:MMTK.PartitionedCollection">MMTK.PartitionedCollection</a>.</p>



<p>PartitionedAtomCollection objects behave like PartitionedCollection
atoms, except that they store only atoms. When a composite chemical
object is added, its atoms are stored instead.</p>



<p>Constructor: PartitionedAtomCollection(<i>partition_size</i>, <i>objects</i>=None)</p>



<p><dl>


<dt><i>partition_size</i></dt>


<dd><p>
the edge length of the cubic cells</p></dd>


<dt><i>objects</i></dt>


<dd><p>
a chemical object or a sequence of chemical objects that
             define the initial content of the collection.
</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.InfiniteUniverse"><h2>Class InfiniteUniverse: Infinite (unbounded and nonperiodic) universe.</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_39.html#Class:MMTK.Universe.Universe">MMTK.Universe.Universe</a>.</p>



<p>Constructor: InfiniteUniverse(<i>forcefield</i>=None)</p>



<p><dl>


<dt><i>forcefield</i></dt>


<dd><p>
a force field object, or <tt>None</tt> for no force field
</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.Complex"><h2>Class Complex: Complex</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_13.html#Class:MMTK.ChemicalObjects.ChemicalObject">MMTK.ChemicalObjects.ChemicalObject</a>.</p>



<p>A complex is an assembly of molecules that are not connected by
chemical bonds.</p>



<p>Constructor: Complex(<i>species</i>, **|properties|)</p>



<p><dl>


<dt><i>species</i></dt>


<dd><p>
a string (not case sensitive) that specifies the complex
             name in the chemical database</p></dd>


<dt><i>properties</i></dt>


<dd><p>
optional keyword properties:<ul>


<li> <p>
position: the center-of-mass position (a vector)
</p>

<li> <p>
configuration: the name of a configuration listed in the database
                   definition of the complex
</p>

<li> <p>
name: the atom name (a string)
</p>

</ul>


</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.AtomCluster"><h2>Class AtomCluster: An agglomeration of atoms</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_13.html#Class:MMTK.ChemicalObjects.ChemicalObject">MMTK.ChemicalObjects.ChemicalObject</a>.</p>



<p>An atom cluster acts like a molecule without any bonds or atom
properties. It can be used to represent a group of atoms that
are known to form a chemical unit but whose chemical properties
are not sufficiently known to define a molecule.</p>



<p>Constructor: AtomCluster(<i>atoms</i>, **|properties|)</p>



<p><dl>


<dt><i>atoms</i></dt>


<dd><p>
a list of atom objects</p></dd>


<dt><i>properties</i></dt>


<dd><p>
optional keyword properties:<ul>


<li> <p>
position: the center-of-mass position (a vector)
</p>

<li> <p>
name: the atom name (a string)
</p>

</ul>


</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.OrthorhombicPeriodicUniverse"><h2>Class OrthorhombicPeriodicUniverse: Periodic universe with orthorhombic elementary cell.</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_39.html#Class:MMTK.Universe.Universe">MMTK.Universe.Universe</a>.</p>



<p>Constructor: OrthorhombicPeriodicUniverse(<i>shape</i>, <i>forcefield</i>=None)</p>



<p><dl>


<dt><i>shape</i></dt>


<dd><p>
a sequence of length three specifying the edge
           lengths along the x, y, and z directions</p></dd>


<dt><i>forcefield</i></dt>


<dd><p>
a force field object, or <tt>None</tt> for no force field
</p></dd>


</dl>
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>scaleSize</i></b>(<i>factor</i>)




<p>Multiplies all edge lengths by <i>factor</i>.</p>





<li> <b><i>setVolume</i></b>(<i>volume</i>)




<p>Multiplies all edge lengths by the same factor such that the cell
volume becomes <i>volume</i>.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.CubicPeriodicUniverse"><h2>Class CubicPeriodicUniverse: Periodic universe with cubic elementary cell.</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_39.html#Class:MMTK.Universe.Universe">MMTK.Universe.Universe</a>.</p>



<p><dl>


<dt><i>shape</i></dt>


<dd><p>
a number specifying the edge
           length along the x, y, and z directions</p></dd>


<dt><i>forcefield</i></dt>


<dd><p>
a force field object, or <tt>None</tt> for no force field
Constructor: CubicPeriodicUniverse(<i>shape</i>, <i>forcefield</i>=None)
</p></dd>


</dl>
</p>



