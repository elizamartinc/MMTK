<a name="Module:MMTK.ChargeFit"><h1>Module MMTK.ChargeFit</h1></a>





<p>This module implements a numerically stable method (based on
Singular Value Decomposition) to fit point charges to values of an
electrostatic potential surface. Two types of constraints are
avaiable: a constraint on the total charge of the system or a subset
of the system, and constraints that force the charges of several atoms
to be equal. There is also a utility function that selects suitable
evaluation points for the electrostatic potential surface. For the
potential evaluation itself, some quantum chemistry program is needed.</p>



<p>The charge fitting method is described in [<a href="MMTK_44.html#Article:Hinsen1997">Hinsen1997</a>].
See also <a href="MMTK_42.html#Example:Miscellaneous:charge_fit.py">Miscellaneous/charge_fit.py</a>.
</p>









<hr width=70%>
<h2>Functions</h2>





<ul>


<li> <p>

<a name="Function:MMTK.ChargeFit.evaluationPoints"><b><i>evaluationPoints</i></b>()</a><br>


</p>



<p>Returns a list of <i>n</i> points suitable for the evaluation of
the electrostatic potential around <i>object</i>. The points are chosen
at random and uniformly in a shell around the object such that
no point has a distance larger than <i>largest</i> from any atom or
smaller than <i>smallest</i> from any non-hydrogen atom.
</p>

</ul>




<hr width=70%>
<a name="Class:MMTK.ChargeFit.ChargeFit"><h2>Class ChargeFit: Fit of point charges to an electrostatic potential surface</h2></a>





<p>Constructor: ChargeFit(<i>system</i>, <i>points</i>, <i>constraints</i>=None)</p>



<p><dl>


<dt><i>system</i></dt>


<dd><p>
any chemical object, usually a molecule</p></dd>


<dt><i>points</i></dt>


<dd><p>
a list of point/potential pairs (a vector for the
            evaluation point, a number for the potential),
            or a dictionary whose keys are Configuration objects
            and whose values are lists of point/potential pairs.
            The latter case permits combined fits for several
            conformations of the system.</p></dd>


<dt><i>constraints</i></dt>


<dd><p>
a list of constraint objects (TotalChargeConstraint
                 and/or EqualityConstraint objects). If the constraints
                 are inconsistent, a warning is printed and the result
                 will satisfy the constraints only in a least-squares
                 sense.</p></dd>


</dl>
</p>



<p>A ChargeFit object acts like a dictionary that stores the fitted charge
value for each atom in the system.
</p>



<hr width=70%>
<a name="Class:MMTK.ChargeFit.TotalChargeConstraint"><h2>Class TotalChargeConstraint: Constraint on the total system charge</h2></a>





<p>To be used with <a href="MMTK_12.html#Class:MMTK.ChargeFit.ChargeFit">MMTK.ChargeFit.ChargeFit</a>.</p>



<p>Constructor:  TotalChargeConstraint(<i>object</i>, <i>charge</i>)</p>



<p><dl>


<dt><i>object</i></dt>


<dd><p>
any object whose total charge is to be constrained</p></dd>


<dt><i>charge</i></dt>


<dd><p>
the total charge value
</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.ChargeFit.EqualityConstraint"><h2>Class EqualityConstraint: Constraint forcing two charges to be equal</h2></a>





<p>To be used with <a href="MMTK_12.html#Class:MMTK.ChargeFit.ChargeFit">MMTK.ChargeFit.ChargeFit</a>.</p>



<p>Constructor:  EqualityConstraint(<i>atom1</i>, <i>atom2</i>), where
<i>atom1</i> and <i>atom2</i> are the two atoms whose charges should be
equal.</p>



<p>Any atom may occur in more than one EqualityConstraint object,
in order to keep the charges of more than two atoms equal.
</p>



