<a name="Module:MMTK.ForceFields.Restraints"><h1>Module MMTK.ForceFields.Restraints</h1></a>





<p>This module contains harmonic restraint terms that can be added
to any force field.</p>



<p>Example:</p>



<p>from MMTK import *
from MMTK.ForceFields import Amber94ForceField
from MMTK.ForceFields.Restraints import HarmonicDistanceRestraint</p>



<p>universe = InfiniteUniverse()
universe.protein = Protein(<tt>bala1</tt>)
force_field = Amber94ForceField() +               HarmonicDistanceRestraint(universe.protein[0][1].peptide.N,
                                        universe.protein[0][1].peptide.O,
                                        0.5, 10.)
universe.setForceField(force_field)
</p>









<hr width=70%>
<a name="Class:MMTK.ForceFields.Restraints.HarmonicDistanceRestraint"><h2>Class HarmonicDistanceRestraint: Harmonic distance restraint between two atoms</h2></a>





<p>Constructor: HarmonicDistanceRestraint(<i>atom1</i>, <i>atom2</i>,
                                       <i>distance</i>, <i>force_constant</i>)</p>



<p><dl>


<dt><i>atom1</i>, <i>atom2</i></dt>


<dd><p>
the two atoms whose distance is restrained</p></dd>


<dt><i>distance</i></dt>


<dd><p>
the distance at which the restraint is zero</p></dd>


<dt><i>force_constant</i></dt>


<dd><p>
the force constant of the restraint term</p></dd>


</dl>
</p>



<p>The functional form of the restraint is
|force_constant|*((r1-r2).length()-|distance|)**2, where
r1 and r2 are the positions of the two atoms.
</p>



<hr width=70%>
<a name="Class:MMTK.ForceFields.Restraints.HarmonicAngleRestraint"><h2>Class HarmonicAngleRestraint: Harmonic angle restraint between three atoms</h2></a>





<p>Constructor: HarmonicAngleRestraint(<i>atom1</i>, <i>atom2</i>, <i>atom3</i>,
                                    <i>angle</i>, <i>force_constant</i>)</p>



<p><dl>


<dt><i>atom1</i>, <i>atom2</i>, <i>atom3</i></dt>


<dd><p>
the three atoms whose angle is restrained;
<i>atom2</i> is the central atom</p></dd>


<dt><i>angle</i></dt>


<dd><p>
the angle at which the restraint is zero</p></dd>


<dt><i>force_constant</i></dt>


<dd><p>
the force constant of the restraint term</p></dd>


</dl>
</p>



<p>The functional form of the restraint is
|force_constant|*(phi-|angle|)**2, where
phi is the angle |atom1|-|atom2|-|atom3|.
</p>



<hr width=70%>
<a name="Class:MMTK.ForceFields.Restraints.HarmonicDihedralRestraint"><h2>Class HarmonicDihedralRestraint: Harmonic dihedral angle restraint between three atoms</h2></a>





<p>Constructor: HarmonicDihedralRestraint(<i>atom1</i>, <i>atom2</i>, <i>atom3</i>, <i>atom4</i>,
                                       <i>angle</i>, <i>force_constant</i>)</p>



<p><dl>


<dt><i>atom1</i>, <i>atom2</i>, <i>atom3</i>, <i>atom4</i></dt>


<dd><p>
the four atoms whose dihedral angle
is restrained; <i>atom2</i> and <i>atom3</i> are on the common axis</p></dd>


<dt><i>angle</i></dt>


<dd><p>
the dihedral angle at which the restraint is zero</p></dd>


<dt><i>force_constant</i></dt>


<dd><p>
the force constant of the restraint term</p></dd>


</dl>
</p>



<p>The functional form of the restraint is
|force_constant|*(phi-|distance|)**2, where
phi is the dihedral angle |atom1|-|atom2|-|atom3|-|atom4|.
</p>



