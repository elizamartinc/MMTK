<a name="Module:MMTK.NormalModes"><h1>Module MMTK.NormalModes</h1></a>





<p>See also the <a href="MMTK_42.html#Example:NormalModes">normal mode</a> example applications.
</p>















<hr width=70%>
<a name="Class:MMTK.NormalModes.Mode"><h2>Class Mode: Single normal mode</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_10.html#Class:MMTK.ParticleVector">MMTK.ParticleVector</a>.</p>



<p>Mode objects are created by indexing a NormalModes object.
They contain the atomic displacements corresponding to a
single mode.</p>



<p>Mode objects are specializations of <a href="MMTK_10.html#Class:MMTK.ParticleVector">MMTK.ParticleVector</a>
objects and support all their operations. In addition, the
frequency corresponding to the mode is stored in the attribute
"frequency".</p>



<p>Note: the normal mode vectors are <i>not</i> mass weighted, and therefore
not orthogonal to each other.
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>view</i></b>(<i>factor</i>=<tt>1.0</tt>, <i>subset</i>=<tt>None</tt>)






<p>Start an animation of the mode. The displacements can be
scaled by a <i>factor</i> to make them better visible, and
a <i>subset</i> of the total system can be specified as well.
This function requires an external viewer, see module
<a href="MMTK_40.html#Module:MMTK.Visualization">MMTK.Visualization</a> for details.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.NormalModes.NormalModes"><h2>Class NormalModes: Normal modes</h2></a>





<p>Constructor: NormalModes(<i>universe</i>, <i>temperature</i>=300)</p>



<p><dl>


<dt><i>universe</i></dt>


<dd><p>
the system for which the normal modes are calculated;
              it must have a force field which provides the second
              derivatives of the potential energy</p></dd>


<dt><i>temperature</i></dt>


<dd><p>
the temperature for which the amplitudes of the
                 atomic displacement vectors are calculated. A
                 value of <tt>None</tt> can be specified to have no scaling
                 at all. In that case the mass-weighted norm
                 of each normal mode is one.</p></dd>


</dl>
</p>



<p>In order to obtain physically reasonable normal modes, the configuration
of the universe must correspond to a local minimum of the potential
energy.</p>



<p>A NormalModes object behaves like a sequence of modes. Individual
modes (see class <a href="MMTK_29.html#Class:MMTK.NormalModes.Mode">MMTK.NormalModes.Mode</a>) can be extracted by
indexing with an integer. Looping over the modes is possible as
well.
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>reduceToRange</i></b>(<i>first</i>, <i>last</i>)






<p>Discards all modes except for those whose numbers are between
<i>first</i> (inclusive) and <i>last</i> (exclusive). This is done to
reduce memory requirements, especially before saving the modes
to a file.</p>





<li> <b><i>fluctuations</i></b>()


<p>Returns a <a href="MMTK_10.html#Class:MMTK.ParticleScalar">MMTK.ParticleScalar</a> containing the thermal
fluctuations for each atom in the universe.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.NormalModes.SparseMatrixNormalModes"><h2>Class SparseMatrixNormalModes: Normal modes using a sparse matrix</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_29.html#Class:MMTK.NormalModes.NormalModes">MMTK.NormalModes.NormalModes</a>.</p>



<p>This class differs from the class NormalModes in that it obtains
the Cartesian force constant matrix in a sparse-matrix format and
uses a sparse-matrix eigenvalue solver from the ARPACK library.
This is advantageous if the Cartesian force constant matrix is
sparse (as it is for force fields without long-range terms), but
for non-sparse matrices the memory requirements are higher than
for NormalModes. Note that the calculation time depends not only
on the size of the system, but also on its frequency spectrum,
because an iterative algorithm is used.</p>



<p>Constructor: SparseMatrixNormalModes(<i>universe</i>, <i>nmodes</i>,
                                     <i>temperature</i>=300)</p>



<p><dl>


<dt><i>universe</i></dt>


<dd><p>
the system for which the normal modes are calculated;
              it must have a force field which provides the second
              derivatives of the potential energy</p></dd>


<dt><i>nmodes</i></dt>


<dd><p>
the number of modes that is calculated. The calculation
            time can grow significantly with an increasing number
            of modes.</p></dd>


<dt><i>temperature</i></dt>


<dd><p>
the temperature for which the amplitudes of the
                 atomic displacement vectors are calculated. A
                 value of <tt>None</tt> can be specified to have no scaling
                 at all. In that case the mass-weighted norm
                 of each normal mode is one.</p></dd>


</dl>
</p>



<p>In order to obtain physically reasonable normal modes, the configuration
of the universe must correspond to a local minimum of the potential
energy.</p>



<p>A SparseMatrixNormalModes object behaves like a sequence of modes.
Individual modes (see class <a href="MMTK_29.html#Class:MMTK.NormalModes.Mode">MMTK.NormalModes.Mode</a>) can be
extracted by indexing with an integer. Looping over the modes is
possible as well.
</p>



<hr width=70%>
<a name="Class:MMTK.NormalModes.SubspaceNormalModes"><h2>Class SubspaceNormalModes: Normal modes in a subspace</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_29.html#Class:MMTK.NormalModes.NormalModes">MMTK.NormalModes.NormalModes</a>.</p>



<p>Constructor: SubspaceNormalModes(<i>universe</i>, <i>basis</i>, <i>temperature</i>=300)</p>



<p><dl>


<dt><i>universe</i></dt>


<dd><p>
the system for which the normal modes are calculated;
              it must have a force field which provides the second
              derivatives of the potential energy</p></dd>


<dt><i>basis</i></dt>


<dd><p>
the basis for the subspace in which the normal modes
           are calculated (or, more precisely, a set of vectors
           spanning the subspace; it does not have to be
           orthogonal). This can either be a sequence of
           <a href="MMTK_10.html#Class:MMTK.ParticleVector">MMTK.ParticleVector</a> objects or a tuple of two
           such sequences. In the second case, the subspace is
           defined by the space spanned by the first set of
           vectors projected on the complement of the space
           spanned by the second set of vectors. The second set
           thus defines directions that are excluded from the
           subspace.</p></dd>


<dt><i>temperature</i></dt>


<dd><p>
the temperature for which the amplitudes of the
                 atomic displacement vectors are calculated. A
                 value of <tt>None</tt> can be specified to have no scaling
                 at all. In that case the mass-weighted norm
                 of each normal mode is one.</p></dd>


</dl>
</p>



<p>In order to obtain physically reasonable normal modes, the configuration
of the universe must correspond to a local minimum of the potential
energy.</p>



<p>A SubspaceNormalModes object behaves like a sequence of modes.
Individual modes (see class <a href="MMTK_29.html#Class:MMTK.NormalModes.Mode">MMTK.NormalModes.Mode</a>) can be
extracted by indexing with an integer. Looping over the modes is
possible as well.
</p>



<hr width=70%>
<a name="Class:MMTK.NormalModes.FiniteDifferenceSubspaceNormalModes"><h2>Class FiniteDifferenceSubspaceNormalModes: Normal modes in a subspace with numerical differentiation</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_29.html#Class:MMTK.NormalModes.SubspaceNormalModes">MMTK.NormalModes.SubspaceNormalModes</a>.</p>



<p>This class differs from SubspaceNormalModes in the way it obtains
the force constant matrix. Instead of obtaining the full Cartesian
force constant matrix from the force field and projecting it on
the subspace, it performs a numerical differentiation of the
gradients along the basis vectors of the subspace. This is useful
in two cases:</p>



<ul>


<li> <p>
for small subspaces this approach uses less memory, because
  the full Cartesian force constant matrix is not needed</p>

<li> <p>
it can be used even if the force field does not provide second
  derivatives</p>

</ul>


<p>Constructor: FiniteDifferenceSubspaceNormalModes(<i>universe</i>,
                    <i>basis</i>, <i>delta</i>=0.0001, <i>temperature</i>=300)</p>



<p><dl>


<dt><i>universe</i></dt>


<dd><p>
the system for which the normal modes are calculated</p></dd>


<dt><i>basis</i></dt>


<dd><p>
the basis for the subspace in which the normal modes
           are calculated (or, more precisely, a set of vectors
           spanning the subspace; it does not have to be orthogonal).
           This can either be a sequence of ParticleVector objects
           or a tuple of two such sequences. In the second case,
           the subspace is defined by the space spanned by the
           first set of vectors projected on the complement of the
           space spanned by the second set of vectors. The second
           set thus defines directions that are excluded from
           the subspace.</p></dd>


<dt><i>delta</i></dt>


<dd><p>
the length of the displacement used for numerical
           differentiation</p></dd>


<dt><i>temperature</i></dt>


<dd><p>
the temperature for which the amplitudes of the
                 atomic displacement vectors are calculated. A
                 value of <tt>None</tt> can be specified to have no scaling
                 at all. In that case the mass-weighted norm
                 of each normal mode is one.</p></dd>


</dl>
</p>



<p>In order to obtain physically reasonable normal modes, the configuration
of the universe must correspond to a local minimum of the potential
energy.</p>



<p>A FiniteDifferenceSubspaceNormalModes object behaves like a
sequence of modes.
Individual modes (see class <a href="MMTK_29.html#Class:MMTK.NormalModes.Mode">MMTK.NormalModes.Mode</a>) can be
extracted by indexing with an integer. Looping over the modes is
possible as well.
</p>



<hr width=70%>
<a name="Class:MMTK.NormalModes.SparseMatrixSubspaceNormalModes"><h2>Class SparseMatrixSubspaceNormalModes: Normal modes in a subspace using a sparse matrix</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_29.html#Class:MMTK.NormalModes.SubspaceNormalModes">MMTK.NormalModes.SubspaceNormalModes</a>.</p>



<p>This class differs from SubspaceNormalModes in that it obtains
the Cartesian force constant matrix in a sparse-matrix format.
This is advantageous if the Cartesian force constant matrix
is sparse (as it is for force fields without long-range terms),
but for non-sparse matrices the memory requirements are
higher than for SubspaceNormalModes.</p>



<p>Constructor: SparseMatrixSubspaceNormalModes(<i>universe</i>, <i>basis</i>,
                                             <i>temperature</i>=300)</p>



<p><dl>


<dt><i>universe</i></dt>


<dd><p>
the system for which the normal modes are calculated;
              it must have a force field which provides the second
              derivatives of the potential energy</p></dd>


<dt><i>basis</i></dt>


<dd><p>
the basis for the subspace in which the normal modes
           are calculated (or, more precisely, a set of vectors
           spanning the subspace; it does not have to be orthogonal).
           This can either be a sequence of ParticleVector objects
           or a tuple of two such sequences. In the second case,
           the subspace is defined by the space spanned by the
           first set of vectors projected on the complement of the
           space spanned by the second set of vectors. The second
           set thus defines directions that are excluded from
           the subspace.</p></dd>


<dt><i>temperature</i></dt>


<dd><p>
the temperature for which the amplitudes of the
                 atomic displacement vectors are calculated. A
                 value of <tt>None</tt> can be specified to have no scaling
                 at all. In that case the mass-weighted norm
                 of each normal mode is one.</p></dd>


</dl>
</p>



<p>In order to obtain physically reasonable normal modes, the configuration
of the universe must correspond to a local minimum of the potential
energy.</p>



<p>A SparseMatrixSubspaceNormalModes object behaves like a sequence
of modes.
Individual modes (see class <a href="MMTK_29.html#Class:MMTK.NormalModes.Mode">MMTK.NormalModes.Mode</a>) can be
extracted by indexing with an integer. Looping over the modes is
possible as well.
</p>



