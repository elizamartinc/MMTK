<a name="Module:MMTK.Trajectory"><h1>Module MMTK.Trajectory</h1></a>































<hr width=70%>
<h2>Functions</h2>





<ul>


<li> <p>

<a name="Function:MMTK.Trajectory.isTrajectory"><b><i>isTrajectory</i></b>()</a><br>


</p>



<p>Returns 1 if <i>object</i> is a trajectory.</p>

<li> <p>

<a name="Function:MMTK.Trajectory.trajectoryInfo"><b><i>trajectoryInfo</i></b>()</a><br>


</p>



<p>Return a string with summarial information about the trajectory
file identified by <i>filename</i>.</p>

</ul>




<hr width=70%>
<a name="Class:MMTK.Trajectory.Trajectory"><h2>Class Trajectory: Trajectory file</h2></a>





<p>Constructor: Trajectory(<i>object</i>, <i>filename</i>, <i>mode</i>="r",
                        <i>comment</i>=None, <i>double_precision</i>=0, <i>cycle</i>=0,
                        <i>block_size</i>=1)</p>



<p><dl>


<dt><i>object</i></dt>


<dd><p>
the object whose data is stored in the trajectory file.
            This can be <tt>None</tt> when opening a file for reading;
            in that case, a universe object is constructed from the
            description stored in the trajectory file. This universe
            object can be accessed via the attribute <tt>universe</tt>
            of the trajectory object.</p></dd>


<dt><i>filename</i></dt>


<dd><p>
the name of the trajectory file</p></dd>


<dt><i>mode</i></dt>


<dd><p>
one of "r" (read-only), "w" (create new file for writing),
          or "a" (append to existing file or create if the file does
          not exist)</p></dd>


<dt><i>comment</i></dt>


<dd><p>
optional comment that is stored in the file; allowed only
             with mode="r"</p></dd>


<dt><i>double_precision</i></dt>


<dd><p>
if non-zero, data in the file is stored using
                      double precision; default is single precision.
                      Note that all I/O via trajectory objects is
                      double precision; conversion from and to single
                      precision file variables is handled automatically.</p></dd>


<dt><i>cycle</i></dt>


<dd><p>
if non-zero, a trajectory is created for a fixed number
           of steps equal to the value of <i>cycle</i>, and these steps
           are used cyclically. This is meant for restart trajectories.</p></dd>


<dt><i>block_size</i></dt>


<dd><p>
an optimization parameter that influences the file
                structure and the I/O performance for very large
                files. A block size of 1 is optimal for sequential
                access to configurations etc., whereas a block size
                equal to the number of steps is optimal for reading
                coordinates or scalar variables along the time axis.
                The default value is 1. Note that older MMTK releases
                always used a block size of 1 and cannot handle
                trajectories with different block sizes.</p></dd>


</dl>
</p>



<p>The data in a trajectory file can be accessed by step or by
variable. If <tt>t</tt> is a Trajectory object, then:</p>



<ul>


<li> <p>

<tt>len(t)</tt> is the number of steps</p>

<li> <p>

<tt>t[i]</tt> is the data for step i, in the form of a dictionary that
  maps variable names to data</p>

<li> <p>

<tt>t[i:j]</tt> and <tt>t[i:j:n]</tt> return a SubTrajectory object that refers
   to a subset of the total number of steps (no data is copied)</p>

<li> <p>

<tt>t.variable</tt> returns the value of the named variable at all
  time steps. If the variable is a simple scalar, it is read
  completely and returned as an array. If the variable contains
  data for each atom, a TrajectoryVariable object is returned
  from which data at specific steps can be obtained by further
  indexing operations.</p>

</ul>


<p>The routines that generate trajectories decide what variables
are used and what they contain. The most frequently used variable
is "configuration", which stores the positions of all atoms.
Other common variables are "time", "velocities", "temperature",
"pressure", and various energy terms whose name end with "_energy".
</p>



<b>Methods:</b><br>
<ul>
<li> <b><i>close</i></b>()


<p>Close the trajectory file. Must be called after writing to
ensure that all buffered data is written to the file. No data
access is possible after closing a file.</p>





<li> <b><i>readParticleTrajectory</i></b>(<i>atom</i>, <i>first</i>=<tt>0</tt>, <i>last</i>=<tt>None</tt>, <i>skip</i>=<tt>1</tt>, <i>variable</i>=<tt>'configuration'</tt>)












<p>Read the values of the specified <i>variable</i> for the specified
<i>atom</i> at all time steps from <i>first</i> to <i>last</i> with an
increment of <i>skip</i>. The result is a ParticleTrajectory object.
If the variable is "configuration", the resulting trajectory
is made continuous by eliminating all jumps caused by periodic
boundary conditions. The pseudo-variable "box_coordinates"
can be read to obtain the values of the variable "configuration"
scaled to box coordinates. For non-periodic universes there is
no difference between box coordinates and real coordinates.</p>





<li> <b><i>readRigidBodyTrajectory</i></b>(<i>object</i>, <i>first</i>=<tt>0</tt>, <i>last</i>=<tt>None</tt>, <i>skip</i>=<tt>1</tt>, <i>reference</i>=<tt>None</tt>)












<p>Read the positions for the specified <i>object</i> at all time steps
from <i>first</i> to <i>last</i> with an increment of <i>skip</i> and extract
the rigid-body motion (center-of-mass position plus orientation as
a quaternion) by an optimal-transformation fit. The result is a
RigidBodyTrajectory object.</p>





<li> <b><i>variables</i></b>()


<p>Returns a list of the names of all variables that are stored
in the trajectory.</p>





<li> <b><i>view</i></b>(<i>first</i>=<tt>0</tt>, <i>last</i>=<tt>None</tt>, <i>step</i>=<tt>1</tt>, <i>object</i>=<tt>None</tt>)










<p>Show an animation of <i>object</i> using the positions in the
trajectory at all time steps from <i>first</i> to <i>last</i> with an
increment of <i>skip</i>. <i>object</i> defaults to the entire universe.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.Trajectory.SubTrajectory"><h2>Class SubTrajectory: Reference to a subset of a trajectory</h2></a>





<p>A SubTrajectory object is created by slicing a Trajectory object
or another SubTrajectory object. It provides all the operations
defined on Trajectory objects.
</p>



<hr width=70%>
<a name="Class:MMTK.Trajectory.TrajectoryVariable"><h2>Class TrajectoryVariable: Variable in a trajectory</h2></a>





<p>A TrajectoryVariable object is created by extracting a variable from
a Trajectory object if that variable contains data for each atom and
is thus potentially large. No data is read from the trajectory file
when a TrajectoryVariable object is created; the read operation
takes place when the TrajectoryVariable is indexed with a specific
step number.</p>



<p>If <tt>t</tt> is a TrajectoryVariable object, then:</p>



<ul>


<li> <p>

<tt>len(t)</tt> is the number of steps</p>

<li> <p>

<tt>t[i]</tt> is the data for step i, in the form of a ParticleScalar,
  a ParticleVector, or a Configuration object, depending on the
  variable</p>

<li> <p>

<tt>t[i:j]</tt> and <tt>t[i:j:n]</tt> return a SubVariable object that refers
   to a subset of the total number of steps
</p>

</ul>


<hr width=70%>
<a name="Class:MMTK.Trajectory.SubVariable"><h2>Class SubVariable: Reference to a subset of a TrajectoryVariable</h2></a>





<p>A <a href="MMTK_43.html#Glossary:Subclass">subclass</a> of <a href="MMTK_37.html#Class:MMTK.Trajectory.TrajectoryVariable">MMTK.Trajectory.TrajectoryVariable</a>.</p>



<p>A SubVariable object is created by slicing a TrajectoryVariable
object or another SubVariable object. It provides all the operations
defined on TrajectoryVariable objects.
</p>



<hr width=70%>
<a name="Class:MMTK.Trajectory.TrajectorySet"><h2>Class TrajectorySet: Trajectory file set</h2></a>





<p>A trajectory set permits to treat a sequence of trajectory files
like a single trajectory for reading data. It behaves like an
object of the class <a href="MMTK_37.html#Class:MMTK.Trajectory.Trajectory">MMTK.Trajectory.Trajectory</a>. The
trajectory files must all contain data for the same system.
The variables stored in the individual files need not be the
same, but only variables common to all files can be accessed.</p>



<p>Constructor: TrajectorySet(<i>object</i>, <i>filename_list</i>)</p>



<p><dl>


<dt><i>object</i></dt>


<dd><p>
the object whose data is stored in the trajectory files.
            This can be (and usually is) <tt>None</tt>;
            in that case, a universe object is constructed from the
            description stored in the first trajectory file. This universe
            object can be accessed via the attribute <tt>universe</tt>
            of the trajectory set object.</p></dd>


<dt><i>filename_list</i></dt>


<dd><p>
a list of trajectory file names or
                   (filename, first_step, last_step, increment)
                   tuples.</p></dd>


</dl>
</p>



<p>Note: depending on how the sequence of trajectories was constructed,
the first configuration of each trajectory might be the same as the
last one in the preceding trajectory. To avoid counting it twice,
specify (filename, 1, None, 1) for all but the first trajectory in
the set.
</p>



<hr width=70%>
<a name="Class:MMTK.Trajectory.TrajectorySetVariable"><h2>Class TrajectorySetVariable: Variable in a trajectory set</h2></a>





<p>A TrajectorySetVariable object is created by extracting a variable from
a TrajectorySet object if that variable contains data for each atom and
is thus potentially large. It behaves exactly like a TrajectoryVariable
object.
</p>



<hr width=70%>
<a name="Class:MMTK.Trajectory.ParticleTrajectory"><h2>Class ParticleTrajectory: Trajectory data for a single particle</h2></a>





<p>A ParticleTrajectory object is created by calling the method
<tt>readParticleTrajectory</tt> on a Trajectory object.
If <tt>pt</tt> is a ParticleTrajectory object, then</p>



<ul>


<li> <p>

<tt>len(pt)</tt> is the number of steps stored in it</p>

<li> <p>

<tt>pt[i]</tt> is the value at step <tt>i</tt> (a vector)
</p>

</ul>


<b>Methods:</b><br>
<ul>
<li> <b><i>translateBy</i></b>(<i>vector</i>)




<p>Adds <i>vector</i> to the values at all steps. This does <i>not</i>
change the data in the trajectory file.</p>





</ul>
<hr width=70%>
<a name="Class:MMTK.Trajectory.RigidBodyTrajectory"><h2>Class RigidBodyTrajectory: Rigid-body trajectory data</h2></a>





<p>A RigidBodyTrajectory object is created by calling the method
<tt>readRigidBodyTrajectory</tt> on a Trajectory object.
If <tt>rbt</tt> is a RigidBodyTrajectory object, then</p>



<ul>


<li> <p>

<tt>len(rbt)</tt> is the number of steps stored in it</p>

<li> <p>

<tt>rbt[i]</tt> is the value at step <tt>i</tt> (a vector for the center of mass
           and a quaternion for the orientation)
</p>

</ul>


<hr width=70%>
<a name="Class:MMTK.Trajectory.TrajectoryOutput"><h2>Class TrajectoryOutput: Trajectory output action</h2></a>





<p>A TrajectoryOutput object is used in the action list of any
trajectory-generating operation. It writes any of the available
data to a trajectory file. It is possible to use several
TrajectoryOutput objects at the same time in order to produce
multiple trajectories from a single run.</p>



<p>Constructor: TrajectoryOutput(<i>trajectory</i>, <i>data</i>=None,
                              <i>first</i>=0, <i>last</i>=None, <i>skip</i>=1)</p>



<p><dl>


<dt><i>trajectory</i></dt>


<dd><p>
a trajectory object or a string, which is interpreted
                as the name of a file that is opened as a trajectory
                in append mode</p></dd>


<dt><i>data</i></dt>


<dd><p>
a list of data categories. All variables provided by the
          trajectory generator that fall in any of the listed categories
          are written to the trajectory file. See the descriptions of
          the trajectory generators for a list of variables and
          categories. By default (<i>data</i> = <tt>None</tt>) the categories
          "configuration", "energy", "thermodynamic", and "time"
          are written.</p></dd>


<dt><i>first</i></dt>


<dd><p>
the number of the first step at which the action is executed</p></dd>


<dt><i>last</i></dt>


<dd><p>
the number of the last step at which the action is executed.
          A value of <tt>None</tt> indicates that the action should be
          executed indefinitely.</p></dd>


<dt><i>skip</i></dt>


<dd><p>
the number of steps to skip between two applications of the
          action
</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.Trajectory.RestartTrajectoryOutput"><h2>Class RestartTrajectoryOutput: Restart trajectory output action</h2></a>





<p>A RestartTrajectoryOutput object is used in the action list of any
trajectory-generating operation. It writes those variables to a
trajectory that the trajectory generator declares as necessary
for restarting.</p>



<p>Constructor: RestartTrajectoryOutput(<i>trajectory</i>, <i>skip</i>=100, <i>length</i>=3)</p>



<p><dl>


<dt><i>trajectory</i></dt>


<dd><p>
a trajectory object or a string, which is interpreted
                as the name of a file that is opened as a trajectory
                in append mode with a cycle length of <i>length</i> and
                double-precision variables</p></dd>


<dt><i>skip</i></dt>


<dd><p>
the number of steps between two write operations to the
          restart trajectory</p></dd>


<dt><i>length</i></dt>


<dd><p>
the number of steps stored in the restart trajectory;
            used only if <i>trajectory</i> is a string
</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.Trajectory.LogOutput"><h2>Class LogOutput: Protocol file output action</h2></a>





<p>A LogOutput object is used in the action list of any
trajectory-generating operation. It writes any of the available
data to a text file.</p>



<p>Constructor: LogOutput(<i>file</i>, <i>data</i>, <i>first</i>=0, <i>last</i>=None, <i>skip</i>=1)</p>



<p><dl>


<dt><i>file</i></dt>


<dd><p>
a file object or a string, which is interpreted as the name
          of a file that is opened in write mode</p></dd>


<dt><i>data</i></dt>


<dd><p>
a list of data categories. All variables provided by the
          trajectory generator that fall in any of the listed categories
          are written to the trajectory file. See the descriptions of
          the trajectory generators for a list of variables and
          categories. By default (<i>data</i> = <tt>None</tt>) the categories
          "energy" and "time" are written.</p></dd>


<dt><i>first</i></dt>


<dd><p>
the number of the first step at which the action is executed</p></dd>


<dt><i>last</i></dt>


<dd><p>
the number of the last step at which the action is executed.
          A value of <tt>None</tt> indicates that the action should be
          executed indefinitely.</p></dd>


<dt><i>skip</i></dt>


<dd><p>
the number of steps to skip between two applications of the
          action
</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.Trajectory.StandardLogOutput"><h2>Class StandardLogOutput: Standard protocol output action</h2></a>





<p>A StandardLogOutput object is used in the action list of any
trajectory-generating operation. It is a specialization of
LogOutput to the most common case and writes data in the categories
"time" and "energy" to the standard output stream.</p>



<p>Constructor: StandardLogOutput(<i>skip</i>=50)</p>



<p><dl>


<dt><i>skip</i></dt>


<dd><p>
the number of steps to skip between two applications of the
          action
</p></dd>


</dl>
</p>



<hr width=70%>
<a name="Class:MMTK.Trajectory.SnapshotGenerator"><h2>Class SnapshotGenerator: Trajectory generator for single steps</h2></a>





<p>A SnapshotGenerator is used for manual assembly of trajectory
files. At each call it writes one step to the trajectory,
using the current state of the universe (configuration, velocities, etc.)
and data provided explicitly with the call.</p>



<p>Constructor: SnapshotGenerator(<i>universe</i>, <i>**options</i>)</p>



<p><dl>


<dt><i>universe</i></dt>


<dd><p>
the universe on which the integrator acts</p></dd>


<dt><i>options</i></dt>


<dd><p>
keyword options:<ul>


<li> <p>
data: a dictionary that supplies values for variables
          that are not part of the universe state (e.g. potential energy)
</p>

<li> <p>
actions: a list of actions to be executed periodically (default is
             none)</p>

</ul>


</p></dd>


</dl>
</p>



<p>Each call to the SnapshotGenerator object produces one step.
All the keyword options listed above can be specified either when
creating the generator or when calling it.
</p>



